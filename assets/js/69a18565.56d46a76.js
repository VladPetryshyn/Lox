"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[694],{2469:(e,t,s)=>{s.r(t),s.d(t,{default:()=>q});var i=s(7961),r=s(7294);class n{accept(){}}class a extends n{name;value;constructor(e,t){super(),this.name=e,this.value=t}accept(e){return e.visitAssignExpr(this)}}class h extends n{left;operator;right;constructor(e,t,s){super(),this.left=e,this.operator=t,this.right=s}accept(e){return e.visitBinaryExpr(this)}}class o extends n{expression;constructor(e){super(),this.expression=e}accept(e){return e.visitGroupingExpr(this)}}class c extends n{value;constructor(e){super(),this.value=e}accept(e){return e.visitLiteralExpr(this)}}class l extends n{operator;right;constructor(e,t){super(),this.operator=e,this.right=t}accept(e){return e.visitUnaryExpr(this)}}class u extends n{name;constructor(e){super(),this.name=e}accept(e){return e.visitVariableExpr(this)}}class p extends n{left;operator;right;constructor(e,t,s){super(),this.left=e,this.operator=t,this.right=s}accept(e){return e.visitLogicalExpr(this)}}class m extends n{callee;paren;args;constructor(e,t,s){super(),this.callee=e,this.paren=t,this.args=s}accept(e){return e.visitCallExpr(this)}}class E extends n{object;name;constructor(e,t){super(),this.object=e,this.name=t}accept(e){return e.visitGetExpr(this)}}class d extends n{keyword;constructor(e){super(),this.keyword=e}accept(e){return e.visitThisExpr(this)}}class v extends n{keyword;method;constructor(e,t){super(),this.keyword=e,this.method=t}accept(e){return e.visitSuperExpr(this)}}class f extends n{object;name;value;constructor(e,t,s){super(),this.object=e,this.name=t,this.value=s}accept(e){return e.visitSetExpr(this)}}const x=e=>{const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s].toLowerCase();return Object.freeze(t)};class S{accept(e){}}class A extends S{statements;constructor(e){super(),this.statements=e}accept(e){return e.visitBlockStmt(this)}}class R extends S{expression;constructor(e){super(),this.expression=e}accept(e){return e.visitExpressionStmt(this)}}class N extends S{condition;thenBranch;elseBranch;constructor(e,t,s){super(),this.condition=e,this.thenBranch=t,this.elseBranch=s}accept(e){return e.visitIfStmt(this)}}class g extends S{expression;constructor(e){super(),this.expression=e}accept(e){return e.visitPrintStmt(this)}}class T extends S{name;initializer;constructor(e,t){super(),this.name=e,this.initializer=t}accept(e){return e.visitVarStmt(this)}}class w extends S{condition;body;constructor(e,t){super(),this.condition=e,this.body=t}accept(e){return e.visitWhileStmt(this)}}class k extends S{name;params;body;constructor(e,t,s){super(),this.name=e,this.params=t,this.body=s}accept(e){return e.visitFunctionStmt(this)}}class I extends S{name;superclass;methods;constructor(e,t,s){super(),this.name=e,this.superclass=t,this.methods=s}accept(e){return e.visitClassStmt(this)}}class b extends S{keyword;value;constructor(e,t){super(),this.keyword=e,this.value=t}accept(e){return e.visitReturnStmt(this)}}const L=x(["NONE","FUNCTION","METHOD","INITIALIZER"]),y=x(["NONE","CLASS","SUBCLASS"]);class C{interpreter=null;scopes=[];currentFunction=L.NONE;currentClass=y.NONE;locals=new Map;constructor(e){this.interpreter=e}resolve(e){if(e){if(e instanceof Array)for(const t of e)this.resolve(t);(e instanceof S||e instanceof n)&&e.accept(this)}}resolveFunction(e,t){const s=this.currentFunction;this.currentFunction=t,this.beginScope();for(const i of e.params)this.declare(i),this.define(i);this.resolve(e.body),this.endScope(),this.currentFunction=s}beginScope(){this.scopes.push(new Map)}endScope(){this.scopes.pop()}visitBlockStmt(e){this.beginScope(),this.resolve(e.statements),this.endScope()}visitClassStmt(e){const t=this.currentClass;this.currentClass=y.CLASS,this.declare(e.name),this.define(e.name),e&&e.superclass&&e.superclass.name&&e.name.lexeme===e.superclass.name.lexeme&&W.error(e.superclass.name.line,"A class can't inherit from itself"),e.superclass&&(this.currentClass=y.SUBCLASS,this.resolve(e.superclass)),e.superclass&&(this.beginScope(),this.scopes[this.scopes.length-1].set("super",!0)),this.beginScope(),this.scopes[this.scopes.length-1].set("this",!0);for(const s of e.methods){const e="init"===s.name.lexeme?L.INITIALIZER:L.METHOD;this.resolveFunction(s,e)}this.endScope(),e.superclass&&this.endScope(),this.currentClass=t}visitExpressionStmt(e){this.resolve(e.expression)}visitIfStmt(e){this.resolve(e.condition),this.resolve(e.thenBranch),e.elseBranch&&this.resolve(e.elseBranch)}visitPrintStmt(e){this.resolve(e.expression)}visitReturnStmt(e){this.currentFunction===L.NONE&&W.error(e.keyword.line,"Can't return from top-level code."),e.value&&(this.currentFunction===L.INITIALIZER&&W.error(e.keyword.line,"Can't return a value from an initializer."),this.resolve(e.value))}visitVarStmt(e){this.declare(e.name),e.initializer&&this.resolve(e.initializer),this.define(e.name)}visitWhileStmt(e){this.resolve(e.condition),this.resolve(e.body)}visitBinaryExpr(e){this.resolve(e.left),this.resolve(e.right)}visitAssignExpr(e){this.resolve(e.value),this.resolveLocal(e,e.name)}visitCallExpr(e){this.resolve(e.callee);for(const t of e.args)this.resolve(t)}visitGetExpr(e){this.resolve(e.object),e.name instanceof u&&this.resolve(e.name)}visistThisExpr(e){this.resolveLocal(e,e.keyword)}visitGroupingExpr(e){this.resolve(e.expression)}visitLiteralExpr(){}visitLogicalExpr(e){this.resolve(e.left),this.resolve(e.right)}visitSetExpr(e){this.resolve(e.value),this.resolve(e.object)}visitSuperExpr(e){this.currentClass==y.NONE?W.error(e.keyword.line,"Can't use 'super' outside of a class."):this.currentClass!=y.SUBCLASS&&W.error(e.keyword.line,"Can't use 'super' in a class with no superclass."),this.resolveLocal(e,e.keyword)}visitThisExpr(e){this.currentClass===y.NONE&&W.error(e.keyword.line,"Can't use this outside of a class."),this.resolveLocal(e,e.keyword)}visitUnaryExpr(e){this.resolve(e.right)}visitFunctionStmt(e){this.declare(e.name),this.define(e.name),this.resolveFunction(e,L.FUNCTION)}visitVariableExpr(e){this.scopes.length>0&&!1===this.scopes[this.scopes.length-1].get(e.name.lexme)&&W.error(e.name.line,"Can't read variable in its own initializer."),this.resolveLocal(e,e.name)}declare(e){if(0===this.scopes.length)return;const t=this.scopes[this.scopes.length-1];t.has(e.lexeme)&&W.error(e.line,"Already a variable with this name in this scope"),t.set(e.lexeme,!1)}define(e){0!==this.scopes.length&&this.scopes[this.scopes.length-1].set(e.lexeme,!0)}resolveLocal(e,t){for(let s=this.scopes.length-1;s>=0;s--)if(this.scopes[s].has(t.lexeme))return void this.interpreter.resolve(e,this.scopes.length-1-s)}}class U extends Error{constructor(e,t){super(t),this.token=e}}class F{values=new Map;enclosing=null;constructor(e){this.enclosing=e}define(e,t){if(this.values.get(e))throw new U(e,`${e} Variable is already defined ${e.lexeme}`);this.values.set(e,t)}assign(e,t){const s=this.values.get(e.lexeme);if(s||s<=0)this.values.set(e.lexeme,t);else{if(!this.enclosing)throw new U(e,`${e} Undefined variable, ${e.lexeme}.`);this.enclosing.assign(e,t)}}get(e){const t=this.values.get(e.lexeme);if(t||0===t)return this.values.get(e.lexeme);if(this.enclosing)return this.enclosing.get(e);throw new U(e,`${e} Undefined variable, ${e.lexeme}.`)}getAt(e,t){return this.ancestor(e).values.get(t)}assignAt(e,t,s){this.ancestor(e).values.set(t.lexeme,s)}ancestor(e){let t=this;for(let s=0;s<e;s++)t=t.enclosing;return t}}class O{arity(){}call(e,t){}}class _{klass=null;fields=new Map;constructor(e){this.klass=e}toString(){return this.klass.name+" instance"}get(e){if(this.fields.has(e.lexeme))return this.fields.get(e.lexeme);const t=this.klass.findMethod(e.lexeme);if(t)return t.bind(this);throw new Error("Undefined property "+e.lexeme+".")}set(e,t){this.fields.set(e.lexeme,t)}}class B extends O{name=null;methods=new Map;superclass=null;constructor(e,t,s){super(),this.superclass=t,this.name=e,this.methods=s}toString(){return this.name}call(e,t){const s=new _(this),i=this.findMethod("init");return i&&i.bind(s).call(e,t),s}findMethod(e){return this.methods.has(e)?this.methods.get(e):this.superclass?this.superclass.findMethod(e):void 0}arity(){const e=this.findMethod("init");return e?e.arity():0}}class M extends O{declaration=null;closure=null;isInitializer=!1;constructor(e,t,s=!1){super(),this.declaration=e,this.closure=t,this.isInitializer=s}call(e,t){const s=new F(this.closure);for(let r=0;r<this.declaration.params.length;r++)s.define(this.declaration.params[r].lexeme,t[r]);try{e.executeBlock(this.declaration.body,s)}catch(i){return this.isInitializer?closure.getAt(0,"this"):i.value}if(this.isInitializer)return this.closure.getAt(0,"this")}bind(e){const t=new F(this.closure);return t.define("this",e),new M(this.declaration,t,this.isInitializer)}arity(){return this.declaration.params.length}toString(){return"<fn "+this.declaration.name.lexeme+">"}}class G{value=null;constructor(e){this.value=e}}const P=x(["LEFT_PAREN","RIGHT_PAREN","LEFT_BRACE","RIGHT_BRACE","COMMA","DOT","MINUS","PLUS","SEMICOLON","SLASH","STAR","LEFT_BRACKET","RIGHT_BRACKET","BANG","BANG_EQUAL","EQUAL","EQUAL_EQUAL","GREATER","GREATER_EQUAL","LESS","LESS_EQUAL","IDENTIFIER","STRING","NUMBER","AND","CLASS","ELSE","FALSE","FUN","FOR","IF","NIL","OR","PRINT","RETURN","SUPER","THIS","TRUE","VAR","WHILE","EOF"]);class H{globals=new F;environment=this.globals;locals=new Map;clearEnvironment(){this.globals=new F,this.environment=this.globals;this.globals.define("clock",new class extends O{arity(){return 0}call(){return Date.now()/1e3}toString(){return"native fn"}}),this.globals.define("push",new class extends O{arity(){return 2}call(e,[t,s]){t.push(s)}toString(){return"native fn"}}),this.globals.define("pop",new class extends O{arity(){return 1}call(e,[t]){t.pop()}toString(){return"native fn"}}),this.globals.define("unshift",new class extends O{arity(){return 2}call(e,[t,s]){t.unshift(s)}toString(){return"native fn"}}),this.globals.define("shift",new class extends O{arity(){return 1}call(e,[t]){t.shift()}toString(){return"native fn"}}),this.globals.define("len",new class extends O{arity(){return 1}call(e,[t]){return t.length}toString(){return"native fn"}})}constructor(){this.clearEnvironment()}visitLiteralExpr({value:e}){if(e instanceof Array)for(const t in e)e[t]=this.evaluate(e[t]);return e}visitGroupingExpr(e){return this.evaluate(e.expression)}evaluate(e){if(e)return e.accept(this)}visitUnaryExpr(e){const t=this.evaluate(e.right);switch(e.operator.type){case P.BANG:return!this.isTruthy(t);case P.MINUS:return-t;case P.PLUS:return+t}return null}visitVariableExpr(e){return this.lookUpVariable(e.name,e)}lookUpVariable(e,t){const s=this.locals.get(t);return s||0===s?this.environment.getAt(s,e.lexeme):this.globals.get(e)}visitBinaryExpr(e){const t=this.evaluate(e.left),s=this.evaluate(e.right);switch(e.operator.type){case P.MINUS:return Number(t)-Number(s);case P.STAR:return Number(t)*Number(s);case P.SLASH:return Number(t)/Number(s);case P.PLUS:return t+s;case P.GREATER:return Number(t)>Number(s);case P.GREATER_EQUAL:return Number(t)>=Number(s);case P.LESS:return Number(t)<Number(s);case P.LESS_EQUAL:return Number(t)<=Number(s);case P.BANG_EQUAL:return!this.isEqual(t,s);case P.EQUAL_EQUAL:return this.isEqual(t,s)}return null}visitCallExpr(e){const t=this.evaluate(e.callee),s=[];for(const i of e.args)s.push(this.evaluate(i));if(!(t instanceof O))throw new U(e.paren,"Can only call functions and classes.");if(s.length!==t.arity())throw new U(e.paren,`Expected ${t.arity()} arguments but got ${s.length}.`);return t.call(this,s)}visitGetExpr(e){const t=this.evaluate(e.object);if(t instanceof Array){if("identifier"===e.name.name.type){return t[this.visitVariableExpr(e.name)]}return t[e.name.value]}if(t instanceof _)return t.get(e.name);throw new U("Only instances have properties")}isTruthy(e){return!!e}isEqual(e,t){return e===t}interpret(e){try{for(const t of e)this.execute(t);this.clearEnvironment()}catch(t){W.runtimeError(t)}}visitExpressionStmt(e){this.evaluate(e.expression)}visitFunctionStmt(e){const t=new M(e,this.environment);this.environment.define(e.name.lexeme,t)}visitVarStmt(e){null!=e.initializer&&this.environment.define(e.name.lexeme,this.evaluate(e.initializer))}visitAssignExpr(e){const t=this.evaluate(e.value),s=this.locals.get(e);return s||0===s?this.environment.assignAt(s,e.name,t):this.globals.assign(e.name,t),t}visitBlockStmt(e){this.executeBlock(e.statements,new F(this.environment))}visitClassStmt(e){let t=null;if(e.superclass&&(t=this.evaluate(e.superclass),!(t instanceof B)))throw new U("Superclass must be a class");this.environment.define(e.name.lexeme,null),e.superclass&&(this.environment=new F(this.environment),this.environment.define("super",t));const s=new Map;for(const r of e.methods){const e=new M(r,this.environment,"init"===r.name.lexeme);s.set(r.name.lexeme,e)}const i=new B(e.name.lexeme,t,s);t&&(this.environment=this.environment.enclosing),this.environment.assign(e.name,i)}visitIfStmt(e){this.isTruthy(this.evaluate(e.condition))?this.execute(e.thenBranch):e.elseBranch&&this.execute(e.elseBranch)}visitLogicalExpr(e){const t=this.evaluate(e.left);if(e.operator.type===P.OR){if(this.isTruthy(t))return t}else if(!this.isTruthy(t))return t;return this.evaluate(e.right)}visitSetExpr(e){const t=this.evaluate(e.object),s=this.evaluate(e.value);if(t instanceof Array)return t[e.name.value]=s,s;if(!(t instanceof _))throw new U("Only instances have fields");return t.set(e.name,s),s}visitSuperExpr(e){let t=this.locals.get(e);const s=this.environment.getAt(t,"super"),i=this.environment.getAt(t-1,"this"),r=s.findMethod(e.method.lexeme);if(!r)throw new U("Undefined property");return r.bind(i)}visitThisExpr(e){return this.lookUpVariable(e.keyword,e)}visitWhileStmt(e){for(;this.isTruthy(this.evaluate(e.condition));)this.execute(e.body)}visitPrintStmt(e){const t=this.evaluate(e.expression);W.output(t)}visitReturnStmt(e){let t=null;throw e.value&&(t=this.evaluate(e.value)),new G(t)}execute(e){e.accept(this)}resolve(e,t){this.locals.set(e,t)}executeBlock(e,t){const s=this.environment;try{this.environment=t;for(const t of e)this.execute(t)}finally{this.environment=s}}}class D{tokens=[];current=0;constructor(e){this.tokens=e}expression(){return this.assignment()}assignment(){const e=this.or();if(this.match(P.EQUAL)){const t=this.previous(),s=this.assignment();if(e instanceof u){const t=e.name;return new a(t,s)}if(e instanceof E){const t=e;return new f(t.object,t.name,s)}this.error(t.line,"Invalid assignment target.")}return e}or(){let e=this.and();for(;this.match(P.OR);){const t=this.previous(),s=this.and();e=new p(e,t,s)}return e}and(){let e=this.equality();for(;this.match(P.AND);){const t=this.previous(),s=this.equality();e=new p(e,t,s)}return e}equality(){let e=this.comparison();for(;this.match(P.BANG_EQUAL,P.EQUAL_EQUAL);){const t=this.previous(),s=this.comparison();e=new h(e,t,s)}return e}match(...e){for(const t of e)if(this.check(t))return this.advance(),!0;return!1}check(...e){if(this.isAtEnd())return!1;for(const t of e)if(this.peek().type===t)return!0;return!1}advance(){return this.isAtEnd()||this.current++,this.previous()}isAtEnd(){return this.peek().type===P.EOF}peek(){return this.tokens[this.current]}next(){return this.tokens[this.current+1]}previous(){return this.tokens[this.current-1]}comparison(){let e=this.term();for(;this.match(P.GREATER,P.GREATER_EQUAL,P.LESS,P.LESS_EQUAL);){const t=this.previous(),s=this.term();e=new h(e,t,s)}return e}term(){let e=this.factor();for(;this.match(P.MINUS,P.PLUS);){const t=this.previous(),s=this.factor();e=new h(e,t,s)}return e}factor(){let e=this.unary();for(;this.match(P.STAR,P.SLASH);){const t=this.previous(),s=this.unary();e=new h(e,t,s)}return e}unary(){if(this.match(P.BANG,P.MINUS)){const e=this.previous(),t=this.unary();return new l(e,t)}return this.call()}finishCall(e){const t=[];if(!this.check(P.RIGHT_PAREN))do{t.length>100&&this.error(this.peek().line,"Can't have more than 100 arguments."),t.push(this.expression())}while(this.match(P.COMMA));const s=this.consume(P.RIGHT_PAREN,"Expect ')' after arguments.");return new m(e,s,t)}call(){let e=this.primary();for(;;){if(this.match(P.LEFT_BRACKET)){const t=this.arrayStmt();if(1!==t.length)throw this.error(this.peek().line,"1");return new E(e,t[0])}if(this.match(P.LEFT_PAREN))e=this.finishCall(e);else{if(!this.match(P.DOT))break;{const t=this.consume(P.IDENTIFIER,"Expect property name after '.'.");e=new E(e,t)}}}return e}primary(){if(this.match(P.FALSE))return new c(!1);if(this.match(P.TRUE))return new c(!0);if(this.match(P.NIL))return new c(null);if(this.match(P.NUMBER,P.STRING))return new c(this.previous().literal);if(this.match(P.SUPER)){const e=this.previous();this.consume(P.DOT,"Expect '.' after 'super'.");const t=this.consume(P.IDENTIFIER,"Expect superclass method name.");return new v(e,t)}if(this.match(P.THIS))return new d(this.previous());if(this.match(P.LEFT_BRACKET)){const e=this.arrayStmt();return new c(e)}if(this.match(P.IDENTIFIER))return new u(this.previous());if(this.match(P.LEFT_PAREN)){const e=this.expression();return this.consume(P.RIGHT_PAREN,"Expect ')' after expression."),new o(e)}throw this.error(this.peek().line,"Expect expression.")}consume(e,t){if(this.check(e))return this.advance();throw this.error(this.peek().line,t)}error(e,t){return W.error(e,t),new Error}synchronize(){for(this.advance();!this.isAtEnd();){if(this.previous().type==P.SEMICOLON)return;switch(this.peek().type){case P.CLASS:case P.FUN:case P.VAR:case P.FOR:case P.IF:case P.WHILE:case P.PRINT:case P.RETURN:return}this.advance()}}parse(){const e=[];for(;!this.isAtEnd();)e.push(this.declaration());return e}statement(){return this.match(P.RETURN)?this.returnStatement():this.match(P.FOR)?this.forStatement():this.match(P.IF)?this.ifStatement():this.match(P.PRINT)?this.printStatement():this.match(P.WHILE)?this.whileStatement():this.match(P.LEFT_BRACE)?new A(this.block()):this.expressionStatement()}printStatement(){const e=this.expression();return this.consume(P.SEMICOLON,"Expect ; after value."),new g(e)}returnStatement(){const e=this.previous();let t=null;return this.check(P.SEMICOLON)||(t=this.expression()),this.consume(P.SEMICOLON,"Expect ';' after return value."),new b(e,t)}whileStatement(){this.consume(P.LEFT_PAREN,"Expect '(' after 'while'");const e=this.expression();this.consume(P.RIGHT_PAREN,"Expect '(' after condition");const t=this.statement();return new w(e,t)}forStatement(){let e;this.consume(P.LEFT_PAREN,"Expect '(' after for"),e=this.match(P.SEMICOLON)?null:this.match(P.VAR)?this.varDeclaration():this.expressionStatement();let t=null;this.check(P.SEMICOLON)||(t=this.expression()),this.consume(P.SEMICOLON,"Expect ; after loop condition.");let s=null;this.check(P.RIGHT_PAREN)||(s=this.expression()),this.consume(P.RIGHT_PAREN,"Expect ')' after for clauses.");let i=this.statement();return s&&(i=new A([i,new R(s)])),t||(t=new c(!0)),i=new w(t,i),e&&(i=new A([e,i])),i}varDeclaration(){const e=this.consume(P.IDENTIFIER,"Expect variable name");let t=null;return this.match(P.EQUAL)&&(t=this.expression()),this.consume(P.SEMICOLON,"Expect ; after variable declaration"),new T(e,t)}arrayStmt(){const e=[];for(;this.check(P.STRING,P.NUMBER,P.IDENTIFIER,P.LEFT_BRACKET,P.COMMA);)if(!this.match(P.COMMA)){const t=this.primary();e.push(t)}return this.consume(P.RIGHT_BRACKET,"Expect ] after array."),e}expressionStatement(){const e=this.expression();return this.consume(P.SEMICOLON,"Expect ; after expression."),new R(e)}func(e){const t=this.consume(P.IDENTIFIER,"Expect "+e+" name.");this.consume(P.LEFT_PAREN,"Expect '(' after "+e+" name.");const s=[];if(!this.check(P.RIGHT_PAREN))do{s.length>100&&this.error(this.peek().line,"Can't have more than 100 parameters."),s.push(this.consume(P.IDENTIFIER,"Expect parameter name."))}while(this.match(P.COMMA));this.consume(P.RIGHT_PAREN,"Expect ')' after parameters."),this.consume(P.LEFT_BRACE,`Expect '{' before ${e} body`);const i=this.block();return new k(t,s,i)}block(){const e=[];for(;!this.check(P.RIGHT_BRACE)&&!this.isAtEnd();){const t=this.declaration();e.push(t)}return this.consume(P.RIGHT_BRACE,"Expect } after block."),e}declaration(){try{return this.match(P.CLASS)?this.classDeclaration():this.match(P.FUN)?this.func("function"):this.match(P.VAR)?this.varDeclaration():this.statement()}catch(e){return this.synchronize(),null}}classDeclaration(){const e=this.consume(P.IDENTIFIER,"Expect class name");let t=null;this.match(P.LESS)&&(this.consume(P.IDENTIFIER,"Expect superclass name."),t=new u(this.previous())),this.consume(P.LEFT_BRACE,"Expect '{' before class body.");const s=[];for(;!this.check(P.RIGHT_BRACE)&&!this.isAtEnd();)s.push(this.func("method"));return this.consume(P.RIGHT_BRACE,"Expect '}' after class body."),new I(e,t,s)}ifStatement(){this.consume(P.LEFT_PAREN,"Expect '(' after 'if'");const e=this.expression();this.consume(P.RIGHT_PAREN,"Expect ')' after if condition");const t=this.statement();let s=null;return this.match(P.ELSE)&&(s=this.statement()),new N(e,t,s)}}class Q{constructor(e,t,s,i){this.type=e,this.lexeme=t,this.literal=s,this.line=i}toString(){return`${this.type} ${this.lexeme} ${this.literal}`}}const z=Object.freeze({and:P.AND,class:P.CLASS,else:P.ELSE,false:P.FALSE,true:P.TRUE,for:P.FOR,if:P.IF,fun:P.FUN,nil:P.NIL,print:P.PRINT,return:P.RETURN,super:P.SUPER,this:P.THIS,var:P.VAR,while:P.WHILE,or:P.OR});class V{source="";tokens=[];line=1;start=0;current=0;constructor(e){this.source=e}scanTokens(){for(;!this.isAtEnd();)this.start=this.current,this.scanToken();return this.tokens.push(new Q(P.EOF,"",null,this.line)),this.tokens}isAtEnd(){return this.current>=this.source.length}scanToken(){const e=this.advance();switch(e){case"(":this.addToken(P.LEFT_PAREN);break;case")":this.addToken(P.RIGHT_PAREN);break;case"{":this.addToken(P.LEFT_BRACE);break;case"}":this.addToken(P.RIGHT_BRACE);break;case"[":this.addToken(P.LEFT_BRACKET);break;case"]":this.addToken(P.RIGHT_BRACKET);break;case",":this.addToken(P.COMMA);break;case".":this.addToken(P.DOT);break;case"-":this.addToken(P.MINUS);break;case"+":this.addToken(P.PLUS);break;case";":this.addToken(P.SEMICOLON);break;case"*":this.addToken(P.STAR);break;case"!":this.addToken(this.match("=")?P.BANG_EQUAL:P.BANG);break;case"=":this.addToken(this.match("=")?P.EQUAL_EQUAL:P.EQUAL);break;case"<":this.addToken(this.match("=")?P.LESS_EQUAL:P.LESS);break;case">":this.addToken(this.match("=")?P.GREATER_EQUAL:P.GREATER);break;case"/":if(this.match("/"))for(;"\n"!=this.peek()&&!this.isAtEnd();)this.advance();else this.match("*")?this.multilineComment():this.addToken(P.SLASH);break;case" ":case"\r":case"\t":break;case"\n":this.line++;break;case'"':this.string();break;default:isNaN(e)?this.isAlphaNumeric(e)?this.identifier():W.error(this.line,"Unexpected character"):this.number()}}advance(){return this.source[this.current++]}addToken(e,t){const s=this.source.substring(this.start,this.current);this.tokens.push(new Q(e,s,t,this.line))}match(e){return!this.isAtEnd()&&(this.source[this.current]===e&&(this.current++,!0))}peek(){return this.isAtEnd()?"\0":this.source[this.current]}string(){for(;'"'!==this.peek()&&!this.isAtEnd();)"\n"==this.peek()&&this.line++,this.advance();if(this.isAtEnd())throw W.error(this.line,"Unterminated string");this.advance(),this.addToken(P.STRING,this.source.substring(this.start+1,this.current-1))}number(){for(;!isNaN(this.peek());)this.advance();if("."==this.peek()&&!isNaN(this.peekNext()))for(this.advance();!isNaN(this.peek());)this.advance();this.addToken(P.NUMBER,Number(this.source.substring(this.start,this.current)))}peekNext(){return this.current+1>=this.source.length?"\0":this.source[this.current+1]}isAlphaNumeric(e){let t,s,i;for(s=0,i=e.length;s<i;s++)if(t=e.charCodeAt(s),!(t>47&&t<58||t>64&&t<91||t>96&&t<123))return!1;return!0}identifier(){for(;this.isAlphaNumeric(this.peek());)this.advance();const e=this.source.substring(this.start,this.current);let t=z[e];t&&"constructor"!==e||(t=P.IDENTIFIER),this.addToken(t)}multilineComment(){let e=1;for(;!this.isAtEnd();){const t=this.advance();if("*"===t&&this.match("/")&&e--,"/"===t&&this.match("*")&&e++,0===e)break}e>0&&W.output("Error, unterminated comment")}}let $,j=[],K=!1;try{window&&document?($=e=>j.push(e),K=!0):$=console.log}catch{$=console.log}const W=new class{hadError=!1;hadRuntimeError=!1;interpreter=new H;output=null;constructor(e){this.output=e}run(e){K&&(j=[],this.hadError=!1,this.hadRuntimeError=!1);const t=new V(e).scanTokens(),s=new D(t).parse();if(this.hadRuntimeError&&!K&&process.exit(70),this.hadRuntimeError)return j;if(this.hadError)return j;return new C(this.interpreter).resolve(s),this.interpreter.interpret(s),K?j:void 0}error(e,t){this.report(e,K?"repl":"file",t)}report(e,t,s){this.output(`[${e}] Error ${t}: ${s}`),this.hadError=!0}runtimeError(e){this.output(e.message+"\n[line "+e.token.line+"]"),this.hadRuntimeError=!0}}($),q=()=>{const[e,t]=(0,r.useState)(""),[s,n]=(0,r.useState)([]);return r.createElement(i.Z,null,r.createElement("div",{className:"repl-header"},r.createElement("h2",null,"Lox Repl"),r.createElement("button",{className:"repl-header__button",onClick:()=>{n(W.run(e))}},"Run")),r.createElement("div",{className:"repl-container"},r.createElement("textarea",{className:"repl-textarea",value:e,onChange:e=>t(e.target.value)}),r.createElement("div",{className:"repl-output"},s.length>0?r.createElement(r.Fragment,null,s.map(((e,t)=>r.createElement("h2",{key:e+t},e)))):r.createElement("h2",null,"Output"))))}}}]);